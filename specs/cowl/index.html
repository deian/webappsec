<!doctype html>
<html lang="en">
 <head>
  
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  
  
  <title>Confinement with Origin Web Labels</title>
  
  
  <link href="../default.css" rel="stylesheet" type="text/css">
  
  
  <style>
  body {
    background: url("https://www.w3.org/StyleSheets/TR/logo-ED") top left no-repeat white;
    background-attachment: fixed;
    color: black;
    font-family: sans-serif;
    margin: 0 auto;
    max-width: 50em;
    padding: 2em 1em 2em 70px;
  }
  :link { color: #00C; background: transparent }
  :visited { color: #609; background: transparent }
  a[href]:active { color: #C00; background: transparent }
  a[href]:hover { background: #ffa }

  a[href] img { border-style: none }

  h1, h2, h3, h4, h5, h6 { text-align: left }
  h1, h2, h3 { color: #005A9C; }
  h1 { font: 170% sans-serif }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  h4 { font: bold 100% sans-serif }
  h5 { font: italic 100% sans-serif }
  h6 { font: small-caps 100% sans-serif }

  .hide { display: none }

  div.head { margin-bottom: 1em }
  div.head h1 { margin-top: 2em; clear: both }
  div.head table { margin-left: 2em; margin-top: 2em }

  p.copyright { font-size: small }
  p.copyright small { font-size: small }

  pre { margin-left: 2em }
  dt { font-weight: bold }

  ul.toc, ol.toc {
    list-style: none;
  }
  </style>
  

  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 

 <body class="h-entry">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Confinement with Origin Web Labels</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft,
    <time class="dt-updated" datetime="2015-06-23">23 June 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec/specs/cowl/">https://w3c.github.io/webappsec/specs/cowl/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCOWL%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[COWL] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/deian/webappsec/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:deian@cs.stanford.edu">Deian Stefan</a> (<span class="p-org org">Stanford University</span>)
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
  
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
</p>
  
   <hr title="Separator for header">
</div>


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>

  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API for specifying privacy and

integrity policies on data, in the form of origin labels, and a
mechanism for confining code according to such policies.  This
allows Web application authors and server operators to shared data
with untrusted—buggy but not malicious—code (e.g., in a mashup
scenario) yet impose restrictions on how the code can share the data
further.</p>




   <p>In addition, this specification defines a light-weight, in-thread

Worker.  Combined with confinement, this allows developers to build
privilege-separated, compartmentalized applications.</p>

</div>


  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>

  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>
  <strong>Changes to this document may be tracked at
  <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong>

</p>
   <p>
	The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BCOWL%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “COWL” in the subject,
	preferably like this:
	“[COWL] <em>…summary of comment…</em>”

</p>
   <p>
	This document was produced by the
  <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>.

</p>
   <p>
	This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
	must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.

</p>
   <p>
  This document is governed by the <a href="http://www.w3.org/2014/Process-20140801/" id="w3c_process_revision">1 August 2014 W3C Process Document</a>.

</p></div>

  <div data-fill-with="at-risk"></div>


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li><a href="#examples"><span class="secno">1.2</span> <span class="content">Use Cases/Examples</span></a>
       <ul class="toc">
        <li><a href="#examples-checker"><span class="secno">1.2.1</span> <span class="content">Untrusted library</span></a>
        <li><a href="#examples-mashup"><span class="secno">1.2.2</span> <span class="content">Third-party mashup</span></a>
        <li><a href="#examples-leastpriv"><span class="secno">1.2.3</span> <span class="content">Least-privileged content</span></a>
        <li><a href="#examples-privsep"><span class="secno">1.2.4</span> <span class="content">Privilege separation</span></a>
        <li><a href="#examples-isolation"><span class="secno">1.2.5</span> <span class="content">User isolation</span></a>
       </ul>
      <li><a href="#trust-model"><span class="secno">1.3</span> <span class="content">Trust Model</span></a>
     </ul>
    <li><a href="#key-concepts-and-terminology"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
    <li><a href="#framework"><span class="secno">3</span> <span class="content">Framework</span></a>
     <ul class="toc">
      <li><a href="#label"><span class="secno">3.1</span> <span class="content">Label interface</span></a>
     </ul>
    <li><a href="#algorithms"><span class="secno">4</span> <span class="content">Algorithms</span></a>
     <ul class="toc">
      <li><a href="#reduce-to-normal-form"><span class="secno">4.1</span> <span class="content">Reduce to Label Normal Form</span></a>
      <li><a href="#subsumes-check"><span class="secno">4.2</span> <span class="content">Subsumes Check</span></a>
     </ul>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
      <li><a href="#conformance-classes"><span class="secno"></span> <span class="content">Conformance Classes</span></a>
     </ul>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul></div>

  <main>









   <section>
  
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>


    <p><em>This section is not normative.</em></p>


    <p>Modern Web applications are conglomerations of JavaScript written by
  multiple authors. Authors routinely incorporate third-party scripts
  into their applications and share user data with third-party
  services (e.g., as part of a <em>mashup</em>).  Unfortunately, in
  the existing model, authors put the user’s data confidentiality and
  integrity at risk when incorporating such untrusted third-party code
  or sharing data with untrusted third-party services.</p>


    <p>Mechanisms such as CORS and CSP can be used to mitigate these risks
  by giving authors control over whom they share data with. But, once
  data is shared, these mechanisms do not impose any restrictions on
  how the code that was "granted access" can further disseminate the
  data.</p>


    <p>This document specifies an extension to the current model called
  Confinement with Origin Web Labels (COWL). COWL provides authors
  with APIs for specifying access control policies on data (including
  content) in terms of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> <a data-link-type="dfn">labels</a>.  These policies are
  enforced in a mandatory fashion, transitively, even once code has
  access to the data.  For example, with COWL, the author of
  <code>https://example.com/</code> can specify that a password is
  confidential to <code>https://example.com/</code> (and thus should
  only be disclosed to <code>https://example.com/</code>) before
  sharing it with a third-party password strength checking service. In
  turn, COWL ensures that the third-party service, which necessarily
  computes on the password, is confined and respects the policy on the
  password, i.e., it cannot disclose the password to any origin other
  than <code>https://example.com/</code>.</p>


    <p>COWL enforces such policies by confining code, at the
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#windows">context</a>-level, according to the sensitivity of the data the
  code has observed. To reap the greatest benefits of COWL, authors
  will need to compartmentalized applications into multiple contexts
  (e.g., <a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a> or <a data-link-type="dfn">light-weight Workers</a>). For example,
  untrusted libraries should be loaded in <a data-link-type="dfn">light-weight Workers</a>
  instead of directly into a page.</p>


    <p>COWL is intended to be used as a defense-in-depth mechanism that can
  restrict how untrusted code handles sensitive data. To prevent
  untrusted code from accessing data in the first place, authors should
  still use discretionary access control mechanisms, such as CSP and
  CORS.</p>


  
    <section>
  
     <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
     


     <p>The goal of COWL is to provide authors with a means for protecting
  the confidentiality and integrity of data that is shared with
  untrusted, whether third-party or their own, code.  Existing
  mechanisms (e.g., CORS and the <a data-link-type="functionish" href="http://www.w3.org/TR/webmessaging/#dom-window-postmessage">postMessage()</a> <a class="idl-code" data-link-type="argument">targetOrigin</a> argument) provide a way for
  restricting which origins may access (shared) data.  But, once
  content has access to data it can usually disseminate it without
  restrictions.  While CSP can be used to confine code, and thus
  restrict how confidential data is disseminated, setting a correct
  CSP policy (as to confine code) is difficult and limited to
  content the author has control over. Indeed, sharing confidential
  data (e.g., via cross-document messaging) implicitly requires the
  author to trust the receiver not to leak the data, accidentally or
  otherwise.  COWL provides a defense-in-depth option for
  protecting data confidentiality and integrity.  In particular,
  with COWL:</p>
     


     <ol>
      <li data-md="">
       <p>Authors should be able to specify confidentiality and integrity
policies on data in terms of origin labels: the origins to whom the
data is confidential and the origins that endorse the data.  This
allows authors to share sensitive data with third-party content and
impose restrictions on the origins with which it can communicate
once it inspects the sensitive data. Dually, it allows authors to
share data via intermediate content while retaining its integrity.</p>
       


      <li data-md="">
       <p>Authors should be able to run code with <em>least privilege</em>
by restricting how the code can disseminate sensitive data.</p>
       


      <li data-md="">
       <p>Authors should be able to <em>privilege separate</em>
applications by loading untrusted scripts in separate
<a data-link-type="dfn">light-weight Workers</a> instead of inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script">script</a></code> elements,
which have the same privileges as content.</p>
       
</ol>
     
  
    </section>

  
    <section>
  
     <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Use Cases/Examples</span><a class="self-link" href="#examples"></a></h3>
     
  
     <h4 class="heading settled" data-level="1.2.1" id="examples-checker"><span class="secno">1.2.1. </span><span class="content">Untrusted library</span><a class="self-link" href="#examples-checker"></a></h4>
     


     <p class="issue" id="issue-2d8404f3"><a class="self-link" href="#issue-2d8404f3"></a> describe password strength checker. Illustrates how
  confidential password can be protected. Other concepts: light-weigh
  Workers, fresh principals/privileges.</p>
     

  
     <h4 class="heading settled" data-level="1.2.2" id="examples-mashup"><span class="secno">1.2.2. </span><span class="content">Third-party mashup</span><a class="self-link" href="#examples-mashup"></a></h4>
     


     <p class="issue" id="issue-93214987"><a class="self-link" href="#issue-93214987"></a> describe client-side mint or encrypted document editor.</p>
     

  
     <h4 class="heading settled" data-level="1.2.3" id="examples-leastpriv"><span class="secno">1.2.3. </span><span class="content">Least-privileged content</span><a class="self-link" href="#examples-leastpriv"></a></h4>
     


     <p class="issue" id="issue-1281a278"><a class="self-link" href="#issue-1281a278"></a> describe how to drop privileges.</p>
     

  
     <h4 class="heading settled" data-level="1.2.4" id="examples-privsep"><span class="secno">1.2.4. </span><span class="content">Privilege separation</span><a class="self-link" href="#examples-privsep"></a></h4>
     


     <p class="issue" id="issue-c5e66481"><a class="self-link" href="#issue-c5e66481"></a> describe how page can be divided into components with
  different privileges.</p>
     

  
     <h4 class="heading settled" data-level="1.2.5" id="examples-isolation"><span class="secno">1.2.5. </span><span class="content">User isolation</span><a class="self-link" href="#examples-isolation"></a></h4>
     


     <p class="issue" id="issue-0e427243"><a class="self-link" href="#issue-0e427243"></a> describe how to privileges can be delegated and used to
  isolate different users of a web site.</p>
     

  
    </section>
  
    <section>
    
     <h3 class="heading settled" data-level="1.3" id="trust-model"><span class="secno">1.3. </span><span class="content">Trust Model</span><a class="self-link" href="#trust-model"></a></h3>
     
    COWL provides developers with a way of imposing restrictions on
    how untrusted code can disseminated sensitive data.  However,
    authors should not share sensitive data with malicious code, since
    such code may be able to exploit covert channels, which are present
    in most browsers, to leak the data.  COWL can only prevent
    information leakage from code that (e.g., is buggy and) exploits
    overt communication channels.


     <p class="note" role="note">Note, COWL should be used as an additional defense layer to other
    security mechanisms such as CSP, SRI, CORS, and iframe <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox">sandbox</a></code>.</p>
     

  
    </section>
</section>



   <section>
  
    <h2 class="heading settled" data-level="2" id="key-concepts-and-terminology"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#key-concepts-and-terminology"></a></h2>
  
    <ol>
    
     <li>
      A label is in <dfn data-dfn-type="dfn" data-noexport="" id="normal-form">normal form<a class="self-link" href="#normal-form"></a></dfn> if reducing it according to
      the <a data-link-type="dfn" href="#reduce-to-label-normal-form">reduce to label normal form</a> algorithm produces the
      same value.
    
     
    
     <li>
      Two labels are <dfn data-dfn-type="dfn" data-noexport="" id="equivalent">equivalent<a class="self-link" href="#equivalent"></a></dfn> if their <a data-link-type="dfn" href="#normal-form">normal form</a>
      values are equal.
    
     
    
     <li>
      A label <var>A</var> <dfn data-dfn-type="dfn" data-noexport="" id="subsumes">subsumes<a class="self-link" href="#subsumes"></a></dfn> another label
      <var>B</var> if the result of running the <a data-link-type="dfn" href="#subsumes-check0">subsumes check</a>
      algorithm on the <a data-link-type="dfn" href="#normal-form">normal form</a>s of <var>A</var> and
      <var>B</var> returns <code>true</code>.
    
     
  
    </ol>
</section>



   <section>
  
    <h2 class="heading settled" data-level="3" id="framework"><span class="secno">3. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>

  
    <section>
    
     <h3 class="heading settled" data-level="3.1" id="label"><span class="secno">3.1. </span><span class="content">Label interface</span><a class="self-link" href="#label"></a></h3>
     
    A <a data-link-type="dfn">Label</a> must have an internal <dfn data-dfn-type="dfn" data-noexport="" id="label-set">label set<a class="self-link" href="#label-set"></a></dfn>, which is
    a non-empty <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a> <code>Set</code> of <a data-link-type="dfn" href="#disjunction-set">disjunction set</a>s.


     <p>A <dfn data-dfn-type="dfn" data-noexport="" id="disjunction-set">disjunction set<a class="self-link" href="#disjunction-set"></a></dfn> is an <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>
    <code>Set</code> of <a data-link-type="dfn" href="http://dom.spec.whatwg.org/#concept-document-url">URL</a>s corresponding to <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>s.</p>
     


     <p>A label is said to an <dfn data-dfn-type="dfn" data-noexport="" id="empty-label">empty label<a class="self-link" href="#empty-label"></a></dfn> if its <a data-link-type="dfn" href="#label-set">label
      set</a> contains a single, empty <a data-link-type="dfn" href="#disjunction-set">disjunction set</a>.</p>
     

    
     <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-label-label">Constructor</a>, <a class="idl-code" data-link-type="constructor" href="#dom-label-labelorigin">Constructor</a>(DOMString <dfn class="idl-code" data-dfn-for="Label/Label(origin)" data-dfn-type="argument" data-export="" id="dom-label-labelorigin-origin">origin<a class="self-link" href="#dom-label-labelorigin-origin"></a></dfn>)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="label0">Label<a class="self-link" href="#label0"></a></dfn> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-label-equalsother">equals</a>(<a data-link-type="idl-name" href="#label0">Label</a> <dfn class="idl-code" data-dfn-for="Label/equals(other)" data-dfn-type="argument" data-export="" id="dom-label-equalsother-other">other<a class="self-link" href="#dom-label-equalsother-other"></a></dfn>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-label-subsumesother">subsumes</a>(<a data-link-type="idl-name" href="#label0">Label</a> <dfn class="idl-code" data-dfn-for="Label/subsumes(other)" data-dfn-type="argument" data-export="" id="dom-label-subsumesother-other">other<a class="self-link" href="#dom-label-subsumesother-other"></a></dfn>);

  <a data-link-type="idl-name" href="#label0">Label</a> <a class="idl-code" data-link-type="method" href="#dom-label-andother">and</a>(<a data-link-type="idl-name" href="#label0">Label</a> <dfn class="idl-code" data-dfn-for="Label/and(other)" data-dfn-type="argument" data-export="" id="dom-label-andother-other">other<a class="self-link" href="#dom-label-andother-other"></a></dfn>);
  <a data-link-type="idl-name" href="#label0">Label</a> <a class="idl-code" data-link-type="method" href="#dom-label-_orother">_or</a>(<a data-link-type="idl-name" href="#label0">Label</a> <dfn class="idl-code" data-dfn-for="Label/_or(other)" data-dfn-type="argument" data-export="" id="dom-label-_orother-other">other<a class="self-link" href="#dom-label-_orother-other"></a></dfn>);

  object <dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="toJSON()" id="dom-label-tojson">toJSON<a class="self-link" href="#dom-label-tojson"></a></dfn>();
  [Throws] static <a data-link-type="idl-name" href="#label0">Label</a> <dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="fromJSON(json)" id="dom-label-fromjsonjson">fromJSON<a class="self-link" href="#dom-label-fromjsonjson"></a></dfn>(object <dfn class="idl-code" data-dfn-for="Label/fromJSON(json)" data-dfn-type="argument" data-export="" id="dom-label-fromjsonjson-json">json<a class="self-link" href="#dom-label-fromjsonjson-json"></a></dfn>);
};
</pre>
     

    
     <dl>
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="constructor" data-export="" id="dom-label-label">Label()<a class="self-link" href="#dom-label-label"></a></dfn>
      
      
      <dd>
        Returns a new <a data-link-type="dfn" href="#empty-label">empty label</a>.
      
      
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="constructor" data-export="" data-lt="Label(origin)" id="dom-label-labelorigin">Label(DOMString origin)<a class="self-link" href="#dom-label-labelorigin"></a></dfn>
      
      
      <dd>
        If the <a class="idl-code" data-link-type="argument" href="#dom-label-labelorigin-origin">origin</a> is not
        a <a data-link-type="dfn" href="http://dom.spec.whatwg.org/#concept-document-url">URL</a>, the constructor MUST throw a
        <code>TypeError</code> exception <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a>.
        Otherwise, it returns a new <a data-link-type="dfn">Label</a> that contains a <a data-link-type="dfn" href="#label-set">label
        set</a> of a single <a data-link-type="dfn" href="#disjunction-set">disjunction set</a>, which itself
        contains the <a data-link-type="dfn" href="http://dom.spec.whatwg.org/#concept-document-url">URL</a> corresponding to the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> of the <a class="idl-code" data-link-type="argument" href="#dom-label-labelorigin-origin">origin</a> parameter.
      
      
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="equals(other)" id="dom-label-equalsother" title="equals(other)">equals(Label other)<a class="self-link" href="#dom-label-equalsother"></a></dfn>
      
      
      <dd>
        Returns <code>true</code> if the <a data-link-type="dfn">Label</a> on which the method
        has been called is <a data-link-type="dfn" href="#equivalent">equivalent</a> to the <a class="idl-code" data-link-type="argument" href="#dom-label-equalsother-other">other</a>
        parameter; otherwise it returns <code>false</code>
      
      
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="subsumes(other)" id="dom-label-subsumesother" title="subsumes(other)">subsumes(Label other)<a class="self-link" href="#dom-label-subsumesother"></a></dfn>
      
      
      <dd>
        Returns <code>true</code> if the <a data-link-type="dfn">Label</a> on which the method
        has been called <a data-link-type="dfn" href="#subsumes">subsumes</a> the <a class="idl-code" data-link-type="argument" href="#dom-label-subsumesother-other">other</a>
        parameter; otherwise it returns <code>false</code>
      
      
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="and(other)" id="dom-label-andother" title="and(other)">and(Label other)<a class="self-link" href="#dom-label-andother"></a></dfn>
      
      
      <dd>
        Returns a new <a data-link-type="dfn">Label</a>, in <a data-link-type="dfn" href="#normal-form">normal form</a>, which is
        <a data-link-type="dfn" href="#equivalent">equivalent</a> to adding the <a class="idl-code" data-link-type="argument" href="#dom-label-andother-other">other</a>’s <a data-link-type="dfn" href="#label-set">label set</a> to the
        <a data-link-type="dfn" href="#label-set">label set</a> of the <a data-link-type="dfn">Label</a> on which the method was
        invoked.
      
      
      
      <dt><dfn class="idl-code" data-dfn-for="Label" data-dfn-type="method" data-export="" data-lt="_or(other)" id="dom-label-_orother" title="_or(other)">_or(Label other)<a class="self-link" href="#dom-label-_orother"></a></dfn>
      
      
      <dd>
        Returns a new <a data-link-type="dfn">Label</a>, in <a data-link-type="dfn" href="#normal-form">normal form</a>, which is
        <a data-link-type="dfn" href="#equivalent">equivalent</a> to adding each <a data-link-type="dfn" href="#disjunction-set">disjunction set</a> of <a class="idl-code" data-link-type="argument" href="#dom-label-_orother-other">other</a>’s <a data-link-type="dfn" href="#label-set">label set</a>
        to each <a data-link-type="dfn" href="#disjunction-set">disjunction set</a> of the <a data-link-type="dfn" href="#label-set">label set</a> of the
        <a data-link-type="dfn">Label</a> on which the method was invoked.
      
      
    
     </dl>
     


     <p class="issue" id="issue-4cfef4cf"><a class="self-link" href="#issue-4cfef4cf"></a> describe the other methods and constructor; should we use
    mathematical representation instead of ECMA-262 Sets?</p>
     

    
     <div class="example" id="example-b7845507"><a class="self-link" href="#example-b7845507"></a>
      Examples of creating confidentiality labels.
      
      <pre>// Create empty label. This corresponds to public data.
var empty = new Label();

// Create a label that may used to protect data sensitive to a.com
var a = new Label('https://a.com');

// Create a label that may used to protect data sensitive to b.com
var a = new Label('https://b.com');

// Create a label that may used to protect data that is
// sensitive to both a.com and b.com
var aANDB = new Label('https://a.com').and('https://b.com');

// Create a label that may used to protect data that either
// a.com or b.com can read
var aORB = new Label('https://a.com').or('https://b.com');
</pre>
      


      <p>Examples of comparing confidentiality labels.</p>
      

      
      <pre>// a.com data is more sensitive than public data:
a.subsumes(empty) === true;
b.subsumes(empty) === true;

// Data that is sensitive to a.com and b.com is more sensitive
// than data that is only sensitive to a.com
aANDb.subsumes(a) === true;
aANDb.subsumes(b) === true;

// Data that that is sensitive to a.com is not comparable to
// data that is sensitive to b.com
a.subsumes(b) === false;
b.subsumes(a) === false;

// Data that is sensitive to either a.com or b.com is less
// sensitive than data that is sensitive to a.com alone
a.subsumes(aOrb) === true;
b.subsumes(aOrb) === true;
</pre>
      
    
     </div>
     

  
    </section>
</section>



   <section>
  
    <h2 class="heading settled" data-level="4" id="algorithms"><span class="secno">4. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
  
    <section>
    
     <h3 class="heading settled" data-level="4.1" id="reduce-to-normal-form"><span class="secno">4.1. </span><span class="content">Reduce to Label Normal Form</span><a class="self-link" href="#reduce-to-normal-form"></a></h3>
     
    The <dfn data-dfn-type="dfn" data-noexport="" id="reduce-to-label-normal-form">reduce to label normal form<a class="self-link" href="#reduce-to-label-normal-form"></a></dfn> algorithm takes a
    <var>label</var> argument and produces a <a data-link-type="dfn">Label</a> value
    according to these steps:


     <p class="issue" id="issue-a82506bb"><a class="self-link" href="#issue-a82506bb"></a> describe the reduction algorithm</p>
     

  
    </section>
  
    <section>
    
     <h3 class="heading settled" data-level="4.2" id="subsumes-check"><span class="secno">4.2. </span><span class="content">Subsumes Check</span><a class="self-link" href="#subsumes-check"></a></h3>
      The <dfn data-dfn-type="dfn" data-noexport="" id="subsumes-check0">subsumes
      check<a class="self-link" href="#subsumes-check0"></a></dfn> algorithm takes a two labels <var>A</var> and
    <var>B</var> and produces a boolean according to these steps:


     <p class="issue" id="issue-a59e59a2"><a class="self-link" href="#issue-a59e59a2"></a> describe the subsumsion algorithm</p>
     

  
    </section>
</section>

</main>

  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>

    
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>

    
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example" id="example-f839f6c8"><a class="self-link" href="#example-f839f6c8"></a>
        
   <p>This is an example of an informative example.</p>
   
    
  </div>

    
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>


  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>

    
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>


  <h3 class="no-ref no-num heading settled" id="conformance-classes"><span class="content">Conformance Classes</span><a class="self-link" href="#conformance-classes"></a></h3>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-user-agent">conformant user agent<a class="self-link" href="#conformant-user-agent"></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-server">conformant server<a class="self-link" href="#conformant-server"></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>




  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>and(other), <a href="#dom-label-andother">3.1</a>
   <li>conformant server, <a href="#conformant-server">Unnumbered section</a>
   <li>conformant user agent, <a href="#conformant-user-agent">Unnumbered section</a>
   <li>disjunction set, <a href="#disjunction-set">3.1</a>
   <li>empty label, <a href="#empty-label">3.1</a>
   <li>equals(other), <a href="#dom-label-equalsother">3.1</a>
   <li>equivalent, <a href="#equivalent">2</a>
   <li>fromJSON(json), <a href="#dom-label-fromjsonjson">3.1</a>
   <li>json, <a href="#dom-label-fromjsonjson-json">3.1</a>
   <li>Label(), <a href="#dom-label-label">3.1</a>
   <li>Label, <a href="#label0">3.1</a>
   <li>Label(origin), <a href="#dom-label-labelorigin">3.1</a>
   <li>label set, <a href="#label-set">3.1</a>
   <li>normal form, <a href="#normal-form">2</a>
   <li>origin, <a href="#dom-label-labelorigin-origin">3.1</a>
   <li>_or(other), <a href="#dom-label-_orother">3.1</a>
   <li>other
    <ul>
     <li>argument for Label/equals(other), <a href="#dom-label-equalsother-other">3.1</a>
     <li>argument for Label/subsumes(other), <a href="#dom-label-subsumesother-other">3.1</a>
     <li>argument for Label/and(other), <a href="#dom-label-andother-other">3.1</a>
     <li>argument for Label/_or(other), <a href="#dom-label-_orother-other">3.1</a>
    </ul>
   <li>reduce to label normal form, <a href="#reduce-to-label-normal-form">4.1</a>
   <li>subsumes, <a href="#subsumes">2</a>
   <li>subsumes
      check, <a href="#subsumes-check0">4.2</a>
   <li>subsumes(other), <a href="#dom-label-subsumesother">3.1</a>
   <li>toJSON(), <a href="#dom-label-tojson">3.1</a></ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li><a data-link-type="biblio" href="#biblio-html5">[html5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#windows">context</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox">sandbox</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-webmessaging">[webmessaging]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/webmessaging/#dom-window-postmessage">postMessage()</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-dom-ls">[dom-ls]</a> defines the following terms:
    <ul>
     <li><a href="http://dom.spec.whatwg.org/#concept-document-url">url</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/scripting.html#script">script</a>
    </ul></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ecma-262"><a class="self-link" href="#biblio-ecma-262"></a>[ECMA-262]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/">ECMA-262 6th Edition, The ECMAScript 2015 Language Specification</a>. June 2015. Standard. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/">http://www.ecma-international.org/ecma-262/6.0/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>Adam Barth. <a href="http://www.ietf.org/rfc/rfc6454.txt">The Web Origin Concept</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc6454.txt">http://www.ietf.org/rfc/rfc6454.txt</a>
   <dt id="biblio-dom-ls"><a class="self-link" href="#biblio-dom-ls"></a>[DOM-LS]
   <dd>Document Object Model URL: <a href="http://dom.spec.whatwg.org/">http://dom.spec.whatwg.org/</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webmessaging"><a class="self-link" href="#biblio-webmessaging"></a>[WEBMESSAGING]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/webmessaging/">HTML5 Web Messaging</a>. 19 May 2015. REC. URL: <a href="http://www.w3.org/TR/webmessaging/">http://www.w3.org/TR/webmessaging/</a></dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
  <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-label-label">Constructor</a>, <a class="idl-code" data-link-type="constructor" href="#dom-label-labelorigin">Constructor</a>(DOMString <a href="#dom-label-labelorigin-origin">origin</a>)]
interface <a href="#label0">Label</a> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-label-equalsother">equals</a>(<a data-link-type="idl-name" href="#label0">Label</a> <a href="#dom-label-equalsother-other">other</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-label-subsumesother">subsumes</a>(<a data-link-type="idl-name" href="#label0">Label</a> <a href="#dom-label-subsumesother-other">other</a>);

  <a data-link-type="idl-name" href="#label0">Label</a> <a class="idl-code" data-link-type="method" href="#dom-label-andother">and</a>(<a data-link-type="idl-name" href="#label0">Label</a> <a href="#dom-label-andother-other">other</a>);
  <a data-link-type="idl-name" href="#label0">Label</a> <a class="idl-code" data-link-type="method" href="#dom-label-_orother">_or</a>(<a data-link-type="idl-name" href="#label0">Label</a> <a href="#dom-label-_orother-other">other</a>);

  object <a href="#dom-label-tojson">toJSON</a>();
  [Throws] static <a data-link-type="idl-name" href="#label0">Label</a> <a href="#dom-label-fromjsonjson">fromJSON</a>(object <a href="#dom-label-fromjsonjson-json">json</a>);
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> describe password strength checker. Illustrates how
  confidential password can be protected. Other concepts: light-weigh
  Workers, fresh principals/privileges.<a href="#issue-2d8404f3"> ↵ </a></div>
   <div class="issue"> describe client-side mint or encrypted document editor.<a href="#issue-93214987"> ↵ </a></div>
   <div class="issue"> describe how to drop privileges.<a href="#issue-1281a278"> ↵ </a></div>
   <div class="issue"> describe how page can be divided into components with
  different privileges.<a href="#issue-c5e66481"> ↵ </a></div>
   <div class="issue"> describe how to privileges can be delegated and used to
  isolate different users of a web site.<a href="#issue-0e427243"> ↵ </a></div>
   <div class="issue"> describe the other methods and constructor; should we use
    mathematical representation instead of ECMA-262 Sets?<a href="#issue-4cfef4cf"> ↵ </a></div>
   <div class="issue"> describe the reduction algorithm<a href="#issue-a82506bb"> ↵ </a></div>
   <div class="issue"> describe the subsumsion algorithm<a href="#issue-a59e59a2"> ↵ </a></div></div></body>
</html>